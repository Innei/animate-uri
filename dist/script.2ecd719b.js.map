{"version":3,"sources":["script.js"],"names":["allHref","document","querySelectorAll","timer","once","map","$$","addEventListener","e","preventDefault","href","getAttribute","charAt","clearInterval","uri","concat","slice","length","title","currentTitle","setInterval","beforeUri","encodeURI","decodeURI","location","pathname","replace","afterUri","history","replaceState","isBuild","indexOf","stepUri","pushState","animateUri","duration","navigator","shouldPushState","init","start","to","startWith","Error","stop","window","animationUrl"],"mappings":"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","file":"script.2ecd719b.js","sourceRoot":"..","sourcesContent":["/*\n * @Author: Innei\n * @Date: 2020-08-13 19:55:12\n * @LastEditTime: 2020-08-13 21:30:51\n * @LastEditors: Innei\n * @FilePath: /url-animation/index.js\n * @Coding with Love\n */\n// @ts-check\nconst allHref = [...document.querySelectorAll('a')]\n\n/**\n * @type {number | null}\n */\nlet timer = null\nlet once = false\nallHref.map(($$) => {\n  $$.addEventListener('click', (e) => {\n    e.preventDefault()\n    const href = $$.getAttribute('href')\n    if (href.charAt(0) === '#') {\n      if (timer) {\n        clearInterval(timer)\n      }\n      const uri = '/'.concat(href.slice(1, href.length))\n      const title = $$.getAttribute('data-title')\n      const currentTitle = document.title\n      timer = setInterval(() => {\n        const beforeUri = encodeURI(\n          decodeURI(location.pathname).replace(\n            /<% emojiSequence %>|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F|\\p{Emoji_Modifier_Base}/gu,\n            '',\n          ),\n        )\n        /**\n         * @type {string}\n         */\n\n        const afterUri = uri\n\n        // const handler = (event) => {\n        //   clearInterval(timer)\n        //   history.pushState(null, title ?? currentTitle, afterUri)\n        //   event.preventDefault()\n        //   const msg = 'Âú∞ÂùÄÊ≠£Âú®ËøáÂ∫¶, Áé∞Âú®Âà∑Êñ∞ÂèØËÉΩÂá∫Áé∞ÈóÆÈ¢òÂì¶'\n        //   event.returnValue = msg\n        //   return msg\n        // }\n\n        if (beforeUri === afterUri) {\n          clearInterval(timer)\n          return history.replaceState(null, title ?? currentTitle, afterUri)\n\n          // window.removeEventListener('beforeunload', handler)\n        }\n        const isBuild = afterUri.indexOf(beforeUri) > -1\n        const stepUri = isBuild\n          ? beforeUri.concat(afterUri.charAt(beforeUri.length))\n          : beforeUri.slice(0, beforeUri.length - 1)\n\n        if (!once) {\n          // window.addEventListener('beforeunload', handler)\n          history.pushState(null, title ?? currentTitle, afterUri)\n        }\n        history.replaceState(\n          null,\n          title ?? currentTitle,\n          `${stepUri}${!isBuild ? `üî®üë¥` : `üçª`}`,\n        )\n\n        once = true\n      }, 100)\n\n      // history.replaceState(null, title ?? currentTitle, uri)\n    }\n  })\n})\n\nconst animateUri = () => {\n  /**\n   * @type {number | null}\n   */\n  let timer = null\n  return {\n    duration: 100,\n    navigator: '',\n    shouldPushState: true,\n    /**\n     *\n     * @param {{duration?: number,shouldPushState?: boolean}}\n     */\n    init(\n      { duration, shouldPushState } = { duration: 100, shouldPushState: true },\n    ) {\n      this.duration = duration ?? 100\n      this.shouldPushState = shouldPushState ?? true\n      return this\n    },\n    /**\n     *\n     * @param {string} to\n     * @param {string | undefined} startWith\n     */\n    start(to, startWith) {\n      if (typeof to !== 'string' || to.charAt(0) !== '/') {\n        throw new Error('to must start with `/`')\n      }\n\n      if (timer) {\n        clearInterval(timer)\n      }\n      if (startWith && startWith.charAt(0) === '/') {\n        history.replaceState(null, '', startWith)\n      }\n      let once = false\n      const currentTitle = document.title\n\n      timer = setInterval(() => {\n        const beforeUri = encodeURI(\n          decodeURI(location.pathname).replace(\n            /<% emojiSequence %>|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F|\\p{Emoji_Modifier_Base}/gu,\n            '',\n          ),\n        )\n\n        // const handler = (event) => {\n        //   clearInterval(timer)\n        //   history.pushState(null, title ?? currentTitle, afterUri)\n        //   event.preventDefault()\n        //   const msg = 'Âú∞ÂùÄÊ≠£Âú®ËøáÂ∫¶, Áé∞Âú®Âà∑Êñ∞ÂèØËÉΩÂá∫Áé∞ÈóÆÈ¢òÂì¶'\n        //   event.returnValue = msg\n        //   return msg\n        // }\n\n        if (beforeUri === to) {\n          clearInterval(timer)\n          return history.replaceState(null, currentTitle, to)\n\n          // window.removeEventListener('beforeunload', handler)\n        }\n        const isBuild = to.indexOf(beforeUri) > -1\n        const stepUri = isBuild\n          ? beforeUri.concat(to.charAt(beforeUri.length))\n          : beforeUri.slice(0, beforeUri.length - 1)\n        if (!once) {\n          this.navigator = to\n          if (this.shouldPushState) {\n            history.pushState(null, currentTitle, to)\n          }\n          once = true\n        }\n        history.replaceState(\n          null,\n          currentTitle,\n          `${stepUri}${!isBuild ? `üî®üë¥` : `üçª`}`,\n        )\n      }, this.duration)\n\n      // history.replaceState(null, title ?? currentTitle, uri)\n    },\n    stop() {\n      clearInterval(timer)\n      return history.replaceState(null, '', this.navigator)\n    },\n  }\n}\n// @ts-ignore\nwindow.animationUrl = animateUri\n"]}