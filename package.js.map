{"version":3,"sources":["package.ts"],"names":[],"mappings":";AASa,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,uBAAA,EAAA,QAAA,kBAAoB,WAI3B,IAAA,OAA4B,EAE5B,EAAY,GAET,MAAA,CAKL,OAAA,SACE,GAAA,IAAA,OAAA,IAAA,EAGsD,CACpD,SAAU,IACV,iBAAiB,GAClB,EALC,EAAQ,EAAA,SACR,EAAe,EAAA,gBAQV,OAFP,EAAW,MAAA,EAAA,EAAY,IACvB,EAAkB,MAAA,GAAA,EACX,CACL,MAAO,KAAK,MACZ,KAAM,KAAK,OAQf,MAAA,SAAM,EAAY,GAAlB,IAAA,EAAA,KACM,GAAc,iBAAP,GAAoC,MAAjB,EAAG,OAAO,GAChC,MAAA,IAAI,MAAM,0BAGd,IACF,EAAQ,cAAc,IAEpB,GAAqC,MAAxB,EAAU,OAAO,IAChC,QAAQ,aAAa,KAAM,GAAI,GAE7B,IAAA,GAAO,EACL,EAAe,SAAS,MAE9B,EAAQ,YAAY,WACZ,IAAA,EAAY,UAChB,UAAU,SAAS,UAAU,QAC3B,8rFACA,KAaA,GAAA,IAAc,EACT,OAAA,EAAK,OAGR,IAAA,EAAU,EAAG,QAAQ,IAAc,EACnC,EAAU,EACZ,EAAU,OAAO,EAAG,OAAO,EAAU,SACrC,EAAU,MAAM,EAAG,EAAU,OAAS,GACrC,IACH,EAAY,EAEV,QAAQ,UAAU,KAAM,EAAc,GAExC,GAAO,GAET,QAAQ,aACN,KACA,EACG,GAAW,EAAmB,KAAT,UA9EjB,MAoFb,KAAA,WAES,OADP,EAAQ,cAAc,GACf,QAAQ,aAAa,KAAM,GAAI","file":"package.js","sourceRoot":"..","sourcesContent":["/*\n * @Author: Innei\n * @Date: 2020-08-13 21:31:23\n * @LastEditTime: 2020-08-13 21:46:59\n * @LastEditors: Innei\n * @FilePath: /url-animation/package.ts\n * @Coding with Love\n */\n\nexport const animateUriFactory = () => {\n  /**\n   * @type {number | null}\n   */\n  let timer: number | undefined = undefined\n  let duration = 100\n  let navigator = ''\n  let shouldPushState = true\n  return {\n    /**\n     *\n     * @param {{duration?: number,shouldPushState?: boolean}}\n     */\n    create(\n      {\n        duration,\n        shouldPushState,\n      }: { duration?: number; shouldPushState?: boolean } = {\n        duration: 100,\n        shouldPushState: true,\n      },\n    ) {\n      duration = duration ?? 100\n      shouldPushState = shouldPushState ?? true\n      return {\n        start: this.start,\n        stop: this.stop,\n      }\n    },\n    /**\n     *\n     * @param {string} to\n     * @param {string | undefined} startWith\n     */\n    start(to: string, startWith: string | undefined) {\n      if (typeof to !== 'string' || to.charAt(0) !== '/') {\n        throw new Error('to must start with `/`')\n      }\n\n      if (timer) {\n        timer = clearInterval(timer) as undefined\n      }\n      if (startWith && startWith.charAt(0) === '/') {\n        history.replaceState(null, '', startWith)\n      }\n      let once = false\n      const currentTitle = document.title\n\n      timer = setInterval(() => {\n        const beforeUri = encodeURI(\n          decodeURI(location.pathname).replace(\n            /<% emojiSequence %>|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F|\\p{Emoji_Modifier_Base}/gu,\n            '',\n          ),\n        )\n\n        // const handler = (event) => {\n        //   clearInterval(timer)\n        //   history.pushState(null, title ?? currentTitle, afterUri)\n        //   event.preventDefault()\n        //   const msg = 'Âú∞ÂùÄÊ≠£Âú®ËøáÂ∫¶, Áé∞Âú®Âà∑Êñ∞ÂèØËÉΩÂá∫Áé∞ÈóÆÈ¢òÂì¶'\n        //   event.returnValue = msg\n        //   return msg\n        // }\n\n        if (beforeUri === to) {\n          return this.stop()\n          // window.removeEventListener('beforeunload', handler)\n        }\n        const isBuild = to.indexOf(beforeUri) > -1\n        const stepUri = isBuild\n          ? beforeUri.concat(to.charAt(beforeUri.length))\n          : beforeUri.slice(0, beforeUri.length - 1)\n        if (!once) {\n          navigator = to\n          if (shouldPushState) {\n            history.pushState(null, currentTitle, to)\n          }\n          once = true\n        }\n        history.replaceState(\n          null,\n          currentTitle,\n          `${stepUri}${!isBuild ? `üî®üë¥` : `üçª`}`,\n        )\n      }, duration)\n\n      // history.replaceState(null, title ?? currentTitle, uri)\n    },\n    stop() {\n      timer = clearInterval(timer) as undefined\n      return history.replaceState(null, '', navigator)\n    },\n  }\n}\n"]}