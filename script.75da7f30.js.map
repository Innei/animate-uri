{"version":3,"sources":["script.js"],"names":["allHref","document","querySelectorAll","timer","once","map","$$","addEventListener","e","preventDefault","href","getAttribute","charAt","clearInterval","uri","concat","slice","length","title","currentTitle","setInterval","beforeUri","encodeURI","decodeURI","location","pathname","replace","afterUri","history","replaceState","isBuild","indexOf","stepUri","pushState","animateUri","duration","navigator","shouldPushState","init","start","to","startWith","Error","stop","window","animationUrl"],"mappings":"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","file":"script.75da7f30.js","sourceRoot":"..","sourcesContent":["/*\n * @Author: Innei\n * @Date: 2020-08-13 19:55:12\n * @LastEditTime: 2020-08-13 21:30:51\n * @LastEditors: Innei\n * @FilePath: /url-animation/index.js\n * @Coding with Love\n */\n// @ts-check\nconst allHref = [...document.querySelectorAll('a')]\n\n/**\n * @type {number | null}\n */\nlet timer = null\nlet once = false\nallHref.map(($$) => {\n  $$.addEventListener('click', (e) => {\n    e.preventDefault()\n    const href = $$.getAttribute('href')\n    if (href.charAt(0) === '#') {\n      if (timer) {\n        clearInterval(timer)\n      }\n      const uri = '/'.concat(href.slice(1, href.length))\n      const title = $$.getAttribute('data-title')\n      const currentTitle = document.title\n      timer = setInterval(() => {\n        const beforeUri = encodeURI(\n          decodeURI(location.pathname).replace(\n            /<% emojiSequence %>|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F|\\p{Emoji_Modifier_Base}/gu,\n            '',\n          ),\n        )\n        /**\n         * @type {string}\n         */\n\n        const afterUri = uri\n\n        // const handler = (event) => {\n        //   clearInterval(timer)\n        //   history.pushState(null, title ?? currentTitle, afterUri)\n        //   event.preventDefault()\n        //   const msg = 'Âú∞ÂùÄÊ≠£Âú®ËøáÂ∫¶, Áé∞Âú®Âà∑Êñ∞ÂèØËÉΩÂá∫Áé∞ÈóÆÈ¢òÂì¶'\n        //   event.returnValue = msg\n        //   return msg\n        // }\n\n        if (beforeUri === afterUri) {\n          clearInterval(timer)\n          return history.replaceState(null, title ?? currentTitle, afterUri)\n\n          // window.removeEventListener('beforeunload', handler)\n        }\n        const isBuild = afterUri.indexOf(beforeUri) > -1\n        const stepUri = isBuild\n          ? beforeUri.concat(afterUri.charAt(beforeUri.length))\n          : beforeUri.slice(0, beforeUri.length - 1)\n\n        if (!once) {\n          // window.addEventListener('beforeunload', handler)\n          history.pushState(null, title ?? currentTitle, afterUri)\n        }\n        history.replaceState(\n          null,\n          title ?? currentTitle,\n          `${stepUri}${!isBuild ? `üî®üë¥` : `üçª`}`,\n        )\n\n        once = true\n      }, 100)\n\n      // history.replaceState(null, title ?? currentTitle, uri)\n    }\n  })\n})\n\nconst animateUri = () => {\n  /**\n   * @type {number | null}\n   */\n  let timer = null\n  return {\n    duration: 100,\n    navigator: '',\n    shouldPushState: true,\n    /**\n     *\n     * @param {{duration?: number,shouldPushState?: boolean}}\n     */\n    init(\n      { duration, shouldPushState } = { duration: 100, shouldPushState: true },\n    ) {\n      this.duration = duration ?? 100\n      this.shouldPushState = shouldPushState ?? true\n      return this\n    },\n    /**\n     *\n     * @param {string} to\n     * @param {string | undefined} startWith\n     */\n    start(to, startWith) {\n      if (typeof to !== 'string' || to.charAt(0) !== '/') {\n        throw new Error('to must start with `/`')\n      }\n\n      if (timer) {\n        clearInterval(timer)\n      }\n      if (startWith && startWith.charAt(0) === '/') {\n        history.replaceState(null, '', startWith)\n      }\n      let once = false\n      const currentTitle = document.title\n\n      timer = setInterval(() => {\n        const beforeUri = encodeURI(\n          decodeURI(location.pathname).replace(\n            /<% emojiSequence %>|\\p{Emoji_Presentation}|\\p{Emoji}\\uFE0F|\\p{Emoji_Modifier_Base}/gu,\n            '',\n          ),\n        )\n\n        // const handler = (event) => {\n        //   clearInterval(timer)\n        //   history.pushState(null, title ?? currentTitle, afterUri)\n        //   event.preventDefault()\n        //   const msg = 'Âú∞ÂùÄÊ≠£Âú®ËøáÂ∫¶, Áé∞Âú®Âà∑Êñ∞ÂèØËÉΩÂá∫Áé∞ÈóÆÈ¢òÂì¶'\n        //   event.returnValue = msg\n        //   return msg\n        // }\n\n        if (beforeUri === to) {\n          clearInterval(timer)\n          return history.replaceState(null, currentTitle, to)\n\n          // window.removeEventListener('beforeunload', handler)\n        }\n        const isBuild = to.indexOf(beforeUri) > -1\n        const stepUri = isBuild\n          ? beforeUri.concat(to.charAt(beforeUri.length))\n          : beforeUri.slice(0, beforeUri.length - 1)\n        if (!once) {\n          this.navigator = to\n          if (this.shouldPushState) {\n            history.pushState(null, currentTitle, to)\n          }\n          once = true\n        }\n        history.replaceState(\n          null,\n          currentTitle,\n          `${stepUri}${!isBuild ? `üî®üë¥` : `üçª`}`,\n        )\n      }, this.duration)\n\n      // history.replaceState(null, title ?? currentTitle, uri)\n    },\n    stop() {\n      clearInterval(timer)\n      return history.replaceState(null, '', this.navigator)\n    },\n  }\n}\n// @ts-ignore\nwindow.animationUrl = animateUri\n"]}